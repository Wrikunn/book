"use strict";$.ajax({url:"./php/api.php",data:{fid:0},dataType:"json",success:function(n){n.result.forEach(function(n){n=$('<option value="'+n.id+'">'+n.name+"</option>");$("#prov").append(n)})}}),$.ajax({url:"./php/buy.php",dataType:"json",success:function(n){var e=new Set,o=[];n.forEach(function(n){var t=sessionStorage.getItem(n.id);1!=t&&2!=t||(e.add(n.master),o.push(n))}),e.forEach(function(t){var e=$('\n            <div class="shopcarPoint">\n                <p>\n                    <span>'+t+"</span>\n                    <span></span>\n                    <span>店主：<b>"+t+'</b></span>\n                    <i>在线交谈</i>\n                </p>\n                <ul></ul>\n                <div>\n                    <span>运送方式：</span>\n                    <span>请与卖家确认</span>\n                    <span>运费：<i></i></span>\n                </div>\n                <strong class="clear-fix"></strong>\n            </div>\n            ');e.insertBefore("#shopcar .shopBuy"),o.forEach(function(n){n.master==t&&(e.find("p").find("span").eq(1).text(n.location),e.find("div").find("i").text(n.transport),$("\n                    <li id="+n.id+">\n                        <img src="+n.imgpath+">\n                        <span>"+n.name+"</span>\n                        <span>"+n.quality+"</span>\n                        <span>"+n.price+"</span>\n                        <div>\n                            x "+n.num+"件\n                        </div>\n                        <i>"+(n.num*n.price).toFixed(2)+"</i>\n                    </li>   \n                    ").appendTo(e.find("ul")))})});for(var t=0,a=0;a<$(".shopcarPoint").find("i").length;a++)Number($(".shopcarPoint").find("i").eq(a).text())&&(t+=Number($(".shopcarPoint").find("i").eq(a).text()));t=t.toFixed(2),$("#shopcar .shopBuy").find("i").eq(0).text(o.length).end().eq(1).text(t),setTimeout(function(){layer.close(index)},100)}}),$("#prov").change(function(){$("#city").html('<option value="">请选择市</option>'),$("#county").html('<option value="">请选择区县</option>'),$("#street").html('<option value="">请选择街道</option>'),""!=this.value&&$.ajax({url:"./php/api.php",data:{fid:$("#prov").val()},dataType:"json",success:function(n){n.result.forEach(function(n){n=$('<option value="'+n.id+'">'+n.name+"</option>");$("#city").append(n)})}})}),$("#city").change(function(){$("#county").html('<option value="">请选择区县</option>'),$("#street").html('<option value="">请选择街道</option>'),""!=this.value&&$.ajax({url:"./php/api.php",data:{fid:$("#city").val()},dataType:"json",success:function(n){n.result.forEach(function(n){n=$('<option value="'+n.id+'">'+n.name+"</option>");$("#county").append(n)})}})}),$("#county").change(function(){$("#street").html('<option value="">请选择街道</option>'),""!=this.value&&$.ajax({url:"./php/api.php",data:{fid:$("#county").val()},dataType:"json",success:function(n){n.result.forEach(function(n){n=$('<option value="'+n.id+'">'+n.name+"</option>");$("#street").append(n)})}})}),$("#addbtn").click(function(){var n=document.querySelector("#prov").options[document.querySelector("#prov").selectedIndex].innerText,t=document.querySelector("#city").options[document.querySelector("#city").selectedIndex].innerText,e=document.querySelector("#county").options[document.querySelector("#county").selectedIndex].innerText;$("#message").show().find("span").text($("#addname").val()+"("+$("#addphone").val()+")").next().text(n+" "+t+" "+e+" "+$("#detaadd").val()).parent().siblings().hide()}),$(".shopBuy").find("button").click(function(){for(var n in sessionStorage)Number(n)&&(0!=sessionStorage.getItem(n)&&$.ajax({url:"./php/car.php",data:{id:n,num:0},async:!1}),sessionStorage.setItem(n,0));layer.msg("支付成功，感谢您的支持",{icon:1,shade:.3,shadeClose:!0},function(){location.href="./index.html"})});